{layout name="layout" /}
<block name="titel" xmlns="http://www.w3.org/1999/html" xmlns="http://www.w3.org/1999/html"><title>
    周边购-GO!{$commodity->getData('title')}</title></block>
<block name="resources">
    {load href="__PUBLIC__/homestatic/js/spxiangxi.js" /}
    {load href="__PUBLIC__/homestatic/css/spxiangxi.css" /}
    {load href="__PUBLIC__/homestatic/js/dizhi.js" /}

</block>


   <asideleft>
    <div class="preview">
        <div id="vertical" class="bigImg">
            <!--<img src="__PUBLIC__/homestatic/img/TB1.jpg" width="400" height="400" alt="" id="midimg"/>-->
            <img src="{$images[0]}" width="400" height="400" alt="" id="midimg"/>
            <div style="display:none;" id="winSelector"></div>
        </div><!--bigImg end-->

        <div class="smallImg">
            <div class="scrollbutton smallImgUp disabled"></div>
            <div id="imageMenu">
                <ul>
                    {volist name="images" id="item"}
                    {eq name="$key" value="0"}
                    <li id="onlickImg"><img src="{$item}" width="68" height="68" alt=""/></li>
                    {else/}
                    <li><img src="{$item}" width="68" height="68" alt=""/></li>
                    {/eq}
                    {/volist}
                </ul>
            </div>
            <div class="scrollbutton smallImgDown"></div>
        </div><!--smallImg end-->
        <div id="bigView" style="display:none;"><img width="800" height="800" alt="" src=""/></div>
    </div>
   </asideleft>

<style>


    .userData {
        behavior: url(#default#userdata);
    }

    /*.add-to-cart{*/
        /*width: 180px;*/
        /*height: 40px;*/
        /*background: #CD0003;*/
        /*color: #fff;*/
        /*text-align: center;*/
        /*line-height: 40px;*/
        /*font-weight: bold;*/
        /*text-decoration: none;*/
        /*font-family: "微软雅黑";*/
        /*display: block; !*将a标签默认的display：inline修改为block*!*/
    /*}*/
    .inline a{
        display: inline-table;
        width: 180px;
        height: 50px;
        background: #CD0003;
        text-align: center;
        line-height: 50px;
        color: #fff;
        font-family: "微软雅黑";
        text-decoration: none;
        font-weight: bold;
    }


</style>
<section id="xxmain">
        <span style="font-size: 20px;font-weight: bold">【{$commodity->getData("title")}】
        </span>
        <div style="height: 6px"></div>
        <div style="background: #ffffcc;width: 660px;height: 300px">
            <div style="height: 5px"></div>
            <span>分类:{$commodity['type']['content']}</span>
            </br></br>
            <span>价格:<i style="color: #d33724" id="i_price">￥--.--</i></span>
            </br></br>
            <span>
      <body onload="initProvince()">

        配送至:
        <select name="province" id="selProvince" onchange="getCity(this.options[this.selectedIndex].value)"
                class="userData">
        </select>
        <select name="city" id="selCity">
        </select>
</body>
        <i style="font-size: 14px">有货</i>
    </span>
          <div style="height: 10px;"></div>


         <div>
                  选择类型:
                  {volist  name="$commodity['specifications']" id="vo"  }
                     <a href="#" onclick=showSpecification("{$vo['repertory']}","{$vo['price']}","{$vo['id']}")>
                         {$vo['content']}</a>
                    {/volist}
         </div>

        </div>
        </br>
        <span >
        <input id="min" name="" type="button" value="-"/>
<input id="text_box" name="" type="text" value="1"/>
<input id="add" name="" type="button" value="+"/>
                库存：<span id="s_repertory">--</span>
    </span>
    <div class="inline">

            <a href="#" style="background-color: #d33724;color: #fff" onclick="postBay()">立即购买</a>
        &nbsp;
            <a href="#" style=" background-color: #d33724;color: #fff" onclick=""  >加入购物车</a>
    </div>
        <form id="post_bay" action="{:url('home/user/buyOne')}" method="post">
            <!--标记规格的ID-->
            <input type="hidden" name="specificationId" id="specificationId" value="">
            <input type="hidden" name="commodityId" value="{$commodity['id']}">
            <input type="hidden" name="count" id="count" value="">
        </form>

</section>


<script type="text/javascript">
    //数量加减
    $(document).ready(function () {
//获得文本框对象
        var t = $("#text_box");
//初始化数量为1,并失效减
        $('#min').attr('disabled', true);
        //数量增加操作
        $("#add").click(function () {
            t.val(parseInt(t.val()) + 1)
            if (parseInt(t.val()) != 1) {
                $('#min').attr('disabled', false);
            }
            document.getElementById("count").value = t.val();
        })
        //数量减少操作
        $("#min").click(function () {
            t.val(parseInt(t.val()) - 1);
            if (parseInt(t.val()) == 1) {
                $('#min').attr('disabled', true);
            }
            document.getElementById("count").value = t.val();
        });

        document.getElementById("count").value = 1;
        //初始化规格
        document.getElementById("specificationId").value = "{$commodity['specifications'][0]['id']}";
        document.getElementById("i_price").innerText = "￥{$commodity['specifications'][0]['price']}";
        document.getElementById("s_repertory").innerText = "{$commodity['specifications'][0]['repertory']}";
    });

    //用户切换规格
    function showSpecification(repertory, price, id) {
        document.getElementById("specificationId").value = "";
        document.getElementById("specificationId").value = id;
        document.getElementById("i_price").innerText = "￥" + price;
        document.getElementById("s_repertory").innerText = repertory;
    }
    //立即购买 提交按钮
    function postBay() {
        var specificationId = document.getElementById("specificationId").value;
        var commodityId = "{$commodity['id']}";
        var url = "{:url('home/user/buyOne')}";
        $("#post_bay").submit();

    }
</script>
