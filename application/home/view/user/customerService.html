{layout name="layout" /}
<block name="titel"><title>退换货记录</title></block>
<block name="resources">
    {load href="__PUBLIC__/login/login.css" /}
    {load href="__PUBLIC__/homestatic/css/myhome.css" /}
</block>
<style>

    left {
        width: 200px;
        height: 100%;
        border-right: 1px solid #CCCCCC;
        color: #000000;
        font-size: 14px;
        text-align: center;
        position: absolute;
        top: 80px;
        left: 0px;
        bottom: 100px;
        position: fixed;
    }

    .div1 {
        text-align: center;
        width: 200px;
        padding-top: 30px;

    }

    .div2 {
        height: 40px;
        line-height: 40px;
        cursor: pointer;
        font-size: 13px;
        position: relative;
        border-bottom: #ccc 1px dotted;

    }

    .div2 a {
        color: #000000;
    }

    .div2 a:hover {
        color: red;
    }

    .jbsz {
        position: absolute;
        height: 20px;
        width: 20px;
        left: 40px;
        top: 10px;
    }

    .right {
        position: relative;
        left: 250px;
        top: 30px;
        right: 0;
        bottom: 0;
        overflow: hidden;

    }

    .conten_margin {
        /*margin-bottom: 20px;*/
        /*margin-right: 20px;*/
        float: left;
        padding: 5px;

    }

    .conten_margin:hover {
        /*border: 1px solid silver;*/
    }

    .conten_margin .titlea {
        width: 180px;
        overflow: hidden; /*超出的隐藏掉*/
        text-overflow: ellipsis; /*超出的用....*/
        white-space: nowrap; /*不换行*/
        color: #666666;
        font-size: 13px;
    }

    .bordera {
        float: left;
        padding: 5px;
        border: 1px solid silver;
        color: #666666;
        font-size: 13px;

    }

    .bordera:hover {
        border: 1px solid red;
        color: red;
    }

    .borderb {
        float: left;
        padding: 5px;
        border: 1px solid silver;
        color: red;
        font-size: 13px;
    }

    .borderb:hover {
        border: 1px solid red;
    }

    .pricea {
        font-size: 18px;
        color: red;
    }

    .pingjiaa {
        font-size: 13px;
        color: #666666;
    }

    .pingjiab {
        font-size: 18px;
        color: red;
    }

    .img_xing {
        vertical-align: middle;
    }

    .btn_guanzhu {
        border: 0;
        background: #F4F4F4;
        vertical-align: middle;
        font-size: 13px;
    }

    #myhomem {
        position: absolute;
        left: 120px;
        top: 30px;
        right: 0px;
        bottom: 0;
        overflow: hidden;
    }

    .s-bar {
        font-family: tahoma, arial, 'Hiragino Sans GB', 'Microsoft YaHei', 宋体, sans-serif;
        color: #fff;
        background: #a0cdeb;
        border: #a0cdeb;
        border-top: #e4eaee;
        font-size: 18px;
        line-height: 18px;
        padding: 11px 10px;
        position: relative;
        width: 85%;
    }

    .text-mod {
        font-family: sans-serif;
        color: #333;
        text-decoration: none;
        line-height: 1;
        font-size: 15px;
    }
</style>
<asidehome>
    <div class="left">
        <div class="div1">
            <div class="div2">
                <div class="div2" style="font-size:25px;font-family: '楷体', '微软雅黑'">
                    <h2>全部功能</h2>
                </div>
                <div class="div2">
                    <div class="div2">
                        <div class="jbsz"></div>
                        <a href="{:url('home/user/userHome')}">我的收藏</a></div>
                    <div class="div2">
                        <div class="jbsz"></div>
                        <a href="{:url('home/user/userOrders',['type'=>'all'])}">全部订单</a>
                    </div>
                    <div class="div2">
                        <div class="jbsz"></div>
                        <a href="{:url('home/user/showCart')}">我的购物车</a></div>
                    <div class="div2">
                        <div class="jbsz"></div>
                        <a href="{:url('home/user/userMessage')}">我的个人资料</a></div>
                    <div class="div2">
                        <div class="jbsz"></div>
                        <a href="{:url('home/user/allComment')}">我的评价</a></div>
                    <div class="div2">
                        <div class="jbsz"></div>
                        <a href="{:url('home/user/customerService')}" style="color: #00a2d4;">退换货</a></div>
                    <div class="div2">
                        <div class="jbsz"></div>
                        <a href="{:url('home/message/index')}">客服</a></div>
                </div>
            </div>
        </div>
    </div>
</asidehome>
<div id="myhomem">
    <div id="con">
        <div style="height: 80px;"></div>
        <div id="box_userMsg">
            <div id="box_user">
                <img src="{$iconRoot.$user['icon']}" height="90" width="90" class="img-circle">&nbsp;&nbsp;&nbsp;
                <span><a href="{:url('home/user/userMessage')}">{$user['user_name']}</a></span>
            </div>
            <div id="box_userSta"></div>
        </div>
        <table border="1" width="700px">
            <tr>
                <th><a href="{:url('home/user/userOrders',['type'=>'statu0'])}">待付款<i style="color: red">{$order_0}</i></a>
                </th>
                <th><a href="{:url('home/user/userOrders',['type'=>'statu1'])}">待发货<i style="color: red">{$order_2+$order_1}</i></a>
                </th>
                <th><a href="{:url('home/user/userOrders',['type'=>'statu3'])}">待收货<i style="color: red">{$order_3}</i></a>
                </th>
                <th><a href="{:url('home/user/userOrders',['type'=>'statu5'])}">待评价<i style="color: red">{$order_5}</i></a>
                </th>
                <th><a href="{:url('home/user/userOrders',['type'=>'statu6'])}">退款返修<i style="color: red">{$order_6}</i></a></th>
            </tr>
        </table>
        <div style="height: 10px"></div>

        <!--第二层开始【我的订单】-->
        <div id="box_order_content">
            <div class="s-bar">我的退换货记录</div>
            <div style="height: 10px"></div>
            <table width="85%" border="1" cellpadding="0" cellspacing="0" style="table-layout:fixed">

                <tr>
                    <td rowspan="3">宝贝</td>
                    <td style="text-overflow: ellipsis;overflow:hidden;width: 35%;"></td>
                    <td rowspan="3">
                        <div style="text-overflow: ellipsis;overflow:hidden;width: 100%;"><span>申请理由</span></div>
                    </td>
                    <td rowspan="3"><span>类型</span></td>
                    <td rowspan="3">
                        <div style="text-overflow: ellipsis;overflow:hidden;width: 100%;"><span>状态</span></div>
                    </td>
                    <td rowspan="3">
                        <div style="text-overflow: ellipsis;overflow:hidden;width: 100%;"><span>操作</span></div>
                    </td>
                </tr>
            </table>
            {volist name="refunds" id="refund"}
            <table width="85%" border="1" cellpadding="0" cellspacing="0" style="table-layout:fixed">

                <tr>
                    <td rowspan="3">
                        <img src="{$imgRoot}{$refund['OrderSpecification']['specification']['commodity']['icon']}"
                             style="height: 90px;width: 80px;" class="img-rounded"/>
                    </td>
                    <td style="text-overflow: ellipsis;overflow:hidden;width: 35%;">
                            {$refund['OrderSpecification']['specification']['commodity']['title']}
                    </td>
                    <td rowspan="3">
                        <div style="text-overflow: ellipsis;overflow:hidden;width: 100%;">
                            <span>
                                {$refund['content']}
                            </span>
                        </div>
                    </td>
                    <td rowspan="3">
                        <span class="label label-info">{$refund["type"]}</span>
                    </td>
                    <td rowspan="3">
                        <div style="text-overflow: ellipsis;overflow:hidden;width: 100%;">
                            <span class="label label-info">{$refund["status"]}</span>
                        </div>
                    </td>

                    <td rowspan="3">
                        <div style="text-overflow: ellipsis;overflow:hidden;width: 100%;">
                            <span>
                                {switch name="$refund->getData('status')"}
                        {case value="0"}
                        <a class="label label-danger" href="#" onclick=withdraw("{$refund['id']}")>取消申请</a>
                        {/case}
                        {case value="1"}
                        {/case}
                        {default /}
                        {/switch}
                            </span>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td style="font-family: 微软雅黑;font-size: 15px;color: #ABABC3">
                        规格：{$refund['OrderSpecification']['specificationcontent']}
                    </td>
                </tr>
                <tr>
                    <td style="font-family: 微软雅黑;font-size: 15px;color: #ABABC3">申请时间：{:date('Y-m-d
                        H:i:s',$refund['creation_time'])}
                    </td>
                </tr>
            </table>
            <hr/>
            {/volist}
        </div>
        <!--第二层结束【我的订单】-->
        {$refunds->render()}
    </div>
</div>

<script type="text/javascript">
    //确认收货
    function withdraw(refundId) {
        if (confirm("卖家还没有处理您的申请，您确认取消吗？")) {
            $.ajax({
                type: "POST",
                url: "{:url('home/user/withdrawRefund')}",
                dataType: "json",
                data: {
                    refundId: refundId
                },
                success: function (msg) {
                    switch (msg) {
                        case "Success":
                            alert("申请取消成功！");
                            document.location.reload();//当前页面
                            break;
                        case "PostError":
                            //非法请求
                            alert("非法请求");
                            break;
                        case "ParameterError":
                            //参数错误
                            alert("参数错误！");
                            break;
                        case "RepeatError":
                            alert('这个申请已经被处理了！');
                            document.location.reload();//当前页面
                            break;
                        default:
                    }
                },
                error: function (msg) {
                    alert(msg);
                },
            });
        }
    }
</script>


